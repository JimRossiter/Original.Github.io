*18 April 2024*

## Common Table Expressions (CTEs)

Certainly! Here's a simple example demonstrating the use of Common Table Expressions (CTEs) in SQL using NBA player data:

```sql
-- Create a Common Table Expression (CTE) to calculate the average points per game (PPG) for each team
WITH TeamPPG AS (
    SELECT team_name, AVG(points) AS avg_ppg
    FROM players
    GROUP BY team_name
)

-- Select teams with an average PPG greater than 100
SELECT team_name
FROM TeamPPG
WHERE avg_ppg > 100;
```

Explanation:

1. We create a CTE named "TeamPPG" that calculates the average points per game (PPG) for each team by selecting the team name and calculating the average of points scored by players on each team.

2. In the main query, we select team names from the "TeamPPG" CTE where the average PPG is greater than 100.

This query demonstrates the advantage of using CTEs by breaking down complex queries into simpler, more manageable parts. It enhances readability and maintainability of the SQL code. 

---

**Diary Entry - April 16, 2024**

Today's learnint focussed on Common Table Expressions (CTEs). Through DataCamp, I explored how CTEs can streamline complex queries, making them more readable and easier to manage. 

As I delved into the NBA dataset in practice, I devised a simple SQL query using CTEs to find teams with an average points per game (PPG) greater than 100 ðŸ”½ This not only solidified my understanding of CTEs but also opened my eyes to their practical applications in real-world scenarios. 
 
```sql
-- Create a Common Table Expression (CTE) to calculate the average points per game (PPG) for each team

WITH TeamPPG AS (
    SELECT team_name, AVG(points) AS avg_ppg
    FROM players
    GROUP BY team_name
)

-- Select teams with an average PPG greater than 100
SELECT team_name
FROM TeamPPG
WHERE avg_ppg > 100;

```
# <ins> Advantages of CTEs </ins> 
- **Readability**: 
  - CTEs make SQL queries more readable by breaking them into smaller, logical parts, enhancing code comprehension and maintenance.

- **Reusability**:
  - CTEs can be referenced multiple times within a single query, avoiding redundancy and improving query efficiency.

- **Clarity**:
  - CTEs provide a clear, named structure for temporary result sets, making the query logic easier to understand compared to nested subqueries.









